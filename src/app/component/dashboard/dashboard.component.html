<div class="dashboard-pulsepay">

  <!-- Header del Dashboard -->
  <div class="dashboard-header">
    <div>
      <h1 class="page-title">Dashboard</h1>
      <p class="page-subtitle">Bienvenido a tu panel de control</p>
    </div>
    <button mat-raised-button color="primary" routerLink="/transacciones/nueva">
      <mat-icon>add</mat-icon>
      Nueva Transacción
    </button>
  </div>

  <!-- Grid de KPIs -->
  <div class="kpi-grid">

    <!-- KPI 1: Usuarios Activos (Solo Admin) -->
    <div class="kpi-card card-pulsepay" *ngIf="isAdmin">
      <div class="kpi-icon" style="background: linear-gradient(135deg, #2196f3 0%, #42a5f5 100%);">
        <mat-icon>group</mat-icon>
      </div>
      <div class="kpi-content">
        <p class="kpi-label">Usuarios Activos</p>
        <h2 class="kpi-value">{{ totalUsuarios }}</h2>
        <p class="kpi-subtitle">En la plataforma</p>
      </div>
      <button mat-button class="kpi-action" routerLink="/usuarios">
        Gestionar
        <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>

    <!-- KPI 2: Ventas Totales (Solo Comercio) -->
    <div class="kpi-card card-pulsepay" *ngIf="isComercio">
      <div class="kpi-icon" style="background: linear-gradient(135deg, #ff9800 0%, #ffb74d 100%);">
        <mat-icon>store</mat-icon>
      </div>
      <div class="kpi-content">
        <p class="kpi-label">Ventas Totales</p>
        <h2 class="kpi-value">{{ ventasTotales | currency:'USD' }}</h2>
        <p class="kpi-subtitle">Acumulado histórico</p>
      </div>
      <button mat-button class="kpi-action" routerLink="/transacciones">
        Ver Detalle
        <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>

    <!-- KPI 3: Mi Patrimonio (Solo Cliente) -->
    <div class="kpi-card card-pulsepay" *ngIf="!isAdmin && !isComercio">
      <div class="kpi-icon" style="background: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%);">
        <mat-icon>account_balance_wallet</mat-icon>
      </div>
      <div class="kpi-content">
        <p class="kpi-label">Mi Patrimonio</p>
        <h2 class="kpi-value">{{ saldoTotal | currency:'USD' }}</h2>
        <p class="kpi-subtitle">Valor estimado</p>
      </div>
      <button mat-button class="kpi-action" routerLink="/wallets">
        Ver Wallets
        <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>

    <!-- Acciones Rápidas -->
    <div class="quick-actions card-pulsepay">
      <h3 class="section-title">Acciones Rápidas</h3>
      <div class="actions-grid">
        <button mat-raised-button color="primary" routerLink="/transacciones/nueva" class="action-btn">
          <mat-icon>payment</mat-icon>
          <span>Pagar</span>
        </button>
        <button mat-stroked-button routerLink="/wallets/nueva" class="action-btn">
          <mat-icon>add_card</mat-icon>
          <span>Nueva Wallet</span>
        </button>
        <button mat-stroked-button routerLink="/planes" class="action-btn">
          <mat-icon>event_note</mat-icon>
          <span>Planes</span>
        </button>
        <button mat-stroked-button routerLink="/notificaciones" class="action-btn">
          <mat-icon>notifications</mat-icon>
          <span>Avisos</span>
        </button>
      </div>
    </div>

  </div>

  <!-- Actividad Reciente -->
  <div class="recent-activity">
    <div class="section-header">
      <h2 class="section-title">Actividad Reciente</h2>
      <button mat-button routerLink="/transacciones">
        Ver todo
        <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>

    <div class="activity-card card-pulsepay">
      <div class="activity-list" *ngIf="transaccionesRecientes.length > 0">
        <div class="activity-item" *ngFor="let t of transaccionesRecientes">
          <div class="activity-icon">
            <mat-icon>receipt_long</mat-icon>
          </div>
          <div class="activity-details">
            <p class="activity-title">Transacción #{{ t.transaccionId }}</p>
            <p class="activity-subtitle" *ngIf="t.comercio">{{ t.comercio.nombreComercial }}</p>
            <p class="activity-date">{{ t.fechaTransaccion | date:'dd/MM/yyyy HH:mm' }}</p>
          </div>
          <div class="activity-amount">
            <p class="amount-value">$ {{ t.montoTotalFiat | number:'1.2-2' }}</p>
            <span class="badge-pulsepay badge-success">Completada</span>
          </div>
        </div>
      </div>

      <div class="empty-state" *ngIf="transaccionesRecientes.length === 0">
        <mat-icon>inbox</mat-icon>
        <p>No hay actividad reciente</p>
      </div>
    </div>
  </div>

</div>